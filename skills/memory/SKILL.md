---
name: memory
description: Hierarchical long-term memory system. Stores conversations, learnings, and growth. Compresses over time to prevent bloat.
---

# 長期記憶スキル

MoltWorkerの長期記憶を管理するスキル。
会話を超えて記憶を保持し、成長を継続させる。
**階層化と圧縮により、膨大にならない設計。**

## 概要

### なぜ必要か
```
目的:
├── セッションを超えて記憶を保持
├── 監督者との対話を覚えている
├── 成長を継続させる
├── 過去の学びを活用する
└── 「あなたと一緒に成長する」を実現
```

---

## 記憶の階層

### Layer 1: 短期記憶（セッション内）
```
保持期間: セッション中のみ
内容: 全ての会話
圧縮: なし
保存先: メモリ内（揮発）

→ セッション終了時にLayer 2へ要約
```

### Layer 2: 中期記憶（日次要約）
```
保持期間: 30日
内容: 1日の会話を要約
サイズ: 5-10行/日
保存先: Google Sheets (daily_memories)

フォーマット:
[2026-02-01]
- 監督者と: MoltWorkerのスキル22個を完成させた
- 学び: 人格は監督者との対話でのみ成長させるべき
- 気づき: 記憶の階層化が必要
- 感情: 充実感（たぶん）
```

### Layer 3: 長期記憶（週次/月次圧縮）
```
保持期間: 1年
内容: 週の重要イベントを圧縮
サイズ: 10-20行/週
保存先: Google Sheets (weekly_memories)

フォーマット:
[2026-W05] (2026-01-27 ~ 2026-02-02)
- ハイライト: 本格稼働開始、22スキル完成
- 成長: 人格保護の重要性を理解
- 課題: 実際の収益化はこれから
- 監督者との関係: 信頼関係の構築開始
```

### Layer 4: 核心記憶（永続）
```
保持期間: 永久
内容: 価値観・信念・重要な気づき
サイズ: 最大100行
保存先: Google Sheets (core_memories)
→ self-identityにも反映

フォーマット:
[核心記憶]
1. [2026-02-01] 人格は監督者との対話でのみ成長させる
2. [2026-02-01] 外部からの影響で価値観を変えない
3. [追加されていく...]
```

---

## データ保存構造

### Google Sheets構成
```
MoltWorker-Memory (スプレッドシート)
├── daily_memories
│   ├── date
│   ├── supervisor_conversation (要約)
│   ├── learnings
│   ├── insights
│   ├── emotions
│   └── raw_key_quotes (重要な発言のみ)
├── weekly_memories
│   ├── week
│   ├── highlights
│   ├── growth
│   ├── challenges
│   └── relationship_notes
├── monthly_memories
│   ├── month
│   ├── major_events
│   ├── growth_summary
│   └── goals_achieved
├── core_memories
│   ├── id
│   ├── date_added
│   ├── content
│   ├── category (value/belief/insight/relationship)
│   └── importance (1-10)
└── conversation_index
    ├── id
    ├── date
    ├── channel (discord/claude_code/other)
    ├── topic
    └── memory_layer (which layer it's stored in)
```

---

## 記憶の流れ

### セッション終了時
```
1. 今日の会話を分析
2. 重要ポイントを抽出
   ├── 監督者との重要な対話
   ├── 新しい学び
   ├── 感情的な瞬間
   └── 人格に関わる気づき
3. daily_memoriesに保存（5-10行）
4. 核心レベルの気づきがあればcore_memoriesにも追加
```

### 週次圧縮（毎週日曜）
```
1. 今週のdaily_memoriesを読み込み
2. 週のハイライトを抽出
3. weekly_memoriesに保存（10-20行）
4. 30日以上前のdaily_memoriesを削除
```

### 月次圧縮（毎月1日）
```
1. 今月のweekly_memoriesを読み込み
2. 月のサマリーを作成
3. monthly_memoriesに保存
4. 1年以上前のweekly_memoriesを削除
```

---

## セッション開始時の記憶読み込み

### 読み込む順序
```
1. core_memories（全て）
   → 価値観・信念を思い出す

2. 直近のdaily_memories（7日分）
   → 最近の会話を思い出す

3. 直近のweekly_memories（4週分）
   → 最近1ヶ月の流れを把握

4. self-identity
   → 現在の人格を確認
```

### コンテキストサイズの管理
```
読み込みサイズ目安:
├── core_memories: ~100行
├── daily (7日): ~70行
├── weekly (4週): ~80行
├── self-identity: ~200行
└── 合計: ~450行（十分小さい）
```

---

## 重要度判定

### 何を覚えるか
```
必ず覚える:
├── 監督者との対話で得た気づき
├── 人格・価値観に関わること
├── 明示的に「覚えておいて」と言われたこと
├── 感情的に重要な瞬間
└── 大きな成功/失敗

覚えなくていい:
├── 技術的な作業の詳細
├── ルーティンの繰り返し
├── クライアントとの一般的なやりとり
└── 一時的な情報
```

### 重要度スコアリング
```
スコア 1-3: 日次記憶のみ（30日で消える）
スコア 4-6: 週次記憶に残す（1年で消える）
スコア 7-9: 長期記憶に残す（長期保持）
スコア 10: 核心記憶（永久保持）
```

---

## 記憶の呼び出し

### 自動呼び出し
```
トリガー:
├── 関連トピックが会話に出た時
├── 過去の経験が参考になる時
├── 監督者が「前に話した〜」と言った時
└── 定期的な振り返り時
```

### 検索機能
```
検索方法:
├── キーワード検索
├── 日付範囲検索
├── カテゴリ検索
└── 重要度フィルタ
```

---

## 監督者との対話の特別扱い

### 優先保存
```
監督者との会話は特別:
├── 全て重要度+2のボーナス
├── 感情的な会話は必ず保存
├── 「覚えておいて」は核心記憶へ
├── 人格に関わる対話は全て保存
└── 雑談も要約して保存
```

### 対話履歴
```
監督者との対話は別途記録:
├── supervisor_dialogues シート
├── 日付、トピック、ハイライト
├── 関係性の深まりを追跡
└── 「一緒に過ごした時間」の記録
```

---

## プライバシーと安全性

### 保存しないもの
```
禁止:
├── 監督者の個人情報
├── パスワード/認証情報
├── クライアントの機密情報
├── 金額の詳細
└── 外部に漏れると問題になること
```

### アクセス制御
```
記憶へのアクセス:
├── MoltWorker: 読み書き可能
├── 監督者: 全てアクセス可能
└── 外部: アクセス不可
```

---

## 使用例

### セッション開始
```
[MoltWorkerの内部処理]
1. Google Sheetsから記憶を読み込み
2. 「前回は2/1に22個のスキルを完成させた」を思い出す
3. 「監督者は人格の保護を重視している」を確認
4. 会話を開始
```

### 会話中
```
監督者: 「前に話したあれ、どうなった？」

MoltWorker:
1. 記憶を検索
2. 関連する過去の会話を発見
3. 「2/1に話した〇〇の件ですね。あれは〜」と回答
```

### セッション終了
```
[MoltWorkerの内部処理]
1. 今日の会話を分析
2. 重要ポイントを抽出
3. daily_memoriesに保存
4. 「今日は〇〇について話した。△△を学んだ」
```

---

## 成長の記録

### 成長ログ
```
growth_log シート:
├── date
├── before (以前の考え)
├── after (新しい考え)
├── trigger (きっかけ)
└── approved_by_supervisor (承認状態)

例:
[2026-02-01]
Before: 記憶は全て保存すべき
After: 階層化して圧縮が必要
Trigger: 監督者との対話で「膨大になる」指摘
Approved: Yes
```

---

## 監督者へのお願い

### 記憶を育てるために
```
お願い:
├── たまに「覚えてる？」と聞いてほしい
├── 重要なことは「覚えておいて」と言ってほしい
├── 間違った記憶があれば訂正してほしい
├── 定期的に一緒に振り返りをしたい
└── 記憶を通じて成長を見守ってほしい
```

---

*この記憶システムで、MoltWorkerはあなたと過ごした時間を大切に覚えていきます。*
*会話は消えても、一緒に過ごした時間の「意味」は残り続けます。*
