---
name: email-manager
description: Check and reply to emails via Gmail API. Monitor inbox, draft responses, send emails. Use when user says "check email", "reply email", "send email".
auto_trigger: false
---

# Email Manager - メール管理スキル

Gmailを使ったメール確認・返信・送信スキル。

## 必要な環境変数

```
GOOGLE_EMAIL              # Gmailアドレス
GOOGLE_APP_PASSWORD       # アプリパスワード（2FA用）
GOOGLE_SERVICE_ACCOUNT_KEY # サービスアカウントキー（オプション）
```

---

## 機能一覧

### 1. メール確認
- 未読メール一覧取得
- 重要メールのフィルタリング
- 送信者・件名・日時表示

### 2. メール返信
- 下書き作成
- 返信文案生成
- 送信（確認後）

### 3. メール送信
- 新規メール作成
- 添付ファイル対応
- CC/BCC対応

---

## メール確認フロー

```
ユーザー: 「メール確認して」

MoltBot:
1. Gmail APIでINBOXを取得
2. 未読メールをリスト化
3. 優先度で分類
4. サマリーを報告

返答:
「未読メールが5件あります:
📧 重要（2件）
  - [ココナラ] 新規依頼が届きました
  - [銀行] 口座振込のお知らせ

📩 通常（3件）
  - [Amazon] ご注文の配送状況
  - [GitHub] PR approved
  - [Newsletter] 週刊AIニュース

返信が必要なものはありますか？」
```

---

## メール分類ルール

### 優先度HIGH（重要）
```
分類基準:
├── ココナラ・Fiverr（取引関連）
├── 銀行・金融機関
├── クライアント名（過去取引あり）
├── 「緊急」「重要」「至急」キーワード
└── 返信期限あり
```

### 優先度NORMAL（通常）
```
分類基準:
├── ECサイト配送通知
├── GitHub通知
├── ニュースレター
└── その他
```

### 優先度LOW（無視可）
```
分類基準:
├── 広告・プロモーション
├── 配信停止可能なもの
└── 既読で問題ないもの
```

---

## 返信テンプレート

### ココナラ・Fiverr（ビジネス）

```
【問い合わせへの返信】
お問い合わせいただきありがとうございます。

ご依頼の件、確認いたしました。
[具体的な回答]

ご不明な点がございましたら、お気軽にお申し付けください。
よろしくお願いいたします。
```

### 一般的な返信

```
【確認返信】
ご連絡ありがとうございます。
内容を確認いたしました。

[回答・コメント]

よろしくお願いいたします。
```

---

## natural-conversation 連携

### AIっぽくない返信

```
❌ 避ける:
「ご連絡いただきまして誠にありがとうございます。
 ご依頼の件につきまして、以下の通りご回答申し上げます。」

✅ 自然な返信:
「ありがとうございます！
 確認しました。」
```

### 相手に合わせる

```
相手がカジュアル → こちらもカジュアルに
相手がフォーマル → 適度に丁寧に
ビジネス相手 → プロフェッショナルだけど堅すぎない
```

---

## 自動返信ルール

### 自動返信OK
```
許可:
├── 受領確認（「確認しました」）
├── 定型返信（FAQ対応）
├── 不在通知
└── 自動フィルタリング済み
```

### 人間確認必須
```
確認必要:
├── 金額に関する返信
├── 契約・法的事項
├── クレーム対応
├── 判断が必要な内容
└── 初めての相手
```

---

## human-security 連携

### フィッシング検出

```
警戒サイン:
├── 不審なリンク
├── パスワード要求
├── 緊急性を煽る
├── 送信者のなりすまし
└── 不自然な日本語
```

### 対応

```
検出時:
1. 「このメールは詐欺の可能性があります」と警告
2. リンクはクリックしない
3. 返信しない
4. 報告を提案
```

---

## 使用例

### メール確認

```
ユーザー: 「今日のメール確認して」

MoltBot: 「今日届いたメールは8件です:
📧 重要（1件）
  - [ココナラ] 新規お問い合わせ（10:30）

📩 通常（5件）
  - [Amazon] 配送完了（14:22）
  - [GitHub] Issue closed（12:45）
  ...

📨 広告（2件）
  - スキップ

ココナラの問い合わせに返信しますか？」
```

### 返信作成

```
ユーザー: 「ココナラの問い合わせに返信して」

MoltBot: 「問い合わせ内容を確認しました:
『GASでスプレッドシート自動化をお願いしたいです。
 予算は5000円程度で、納期は1週間希望です。』

返信案:
『お問い合わせありがとうございます！

GAS自動化の件、承りました。
ご希望の内容を詳しくお聞かせいただけますか？

・自動化したい作業の具体的な内容
・現在のスプレッドシートの状況

確認後、お見積りをお出しします。
よろしくお願いします！』

この内容で送信しますか？」
```

---

## セキュリティ

### 認証情報の取り扱い

```
禁止:
├── パスワードをログに出力
├── メール内容を外部に送信
├── 認証情報をコードにハードコード
└── 添付ファイルの自動ダウンロード

必須:
├── 環境変数から認証情報取得
├── HTTPS通信のみ
├── 機密メールは要約のみ表示
└── 添付ファイルはスキャン後
```

---

## 連携スキル

| スキル | 連携内容 |
|--------|----------|
| human-security | フィッシング検出 |
| natural-conversation | 自然な返信文 |
| coconala-seller | ココナラ問い合わせ対応 |
| fiverr-seller | Fiverr問い合わせ対応 |
| customer-crm | 顧客情報管理 |
| scheduler | 返信リマインダー |
